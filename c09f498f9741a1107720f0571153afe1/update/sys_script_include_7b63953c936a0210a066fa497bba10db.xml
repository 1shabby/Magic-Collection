<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_759224_magic_c_0.magic_utils</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description>Generic Utils for the Magic Collection application.</description>
        <mobile_callable>false</mobile_callable>
        <name>magic_utils</name>
        <sandbox_callable>true</sandbox_callable>
        <script><![CDATA[var magic_utils = Class.create();
magic_utils.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {

    /**
     * Description: Takes in set_id and returns the sys_id of the record on the system
     * Parameters: [string]: set_id - the string id used to identify a set;
     * Returns: [string]: sys_id of the set record from the system.
     */

    getSetRecord: function(set_id) {
        var setGr = new GlideRecord('x_759224_magic_c_0_mtg_sets');
        setGr.addQuery('id', set_id);
        setGr.query();
        setGr.next();
        return setGr.getUniqueValue();
    },

    /**
     * Description: Takes in an image string (generally the html one from a card) and grabs the source link of the image. If there isn't one, sets it to be the default mtg backing.
     * Parameters: [string]: img - The value from the image field on a card.
     * Returns: [string]: source url for the image, or the default back image.
     */
   
    getImgSrc: function(img) {
        var regex = /<img[^>]*\s+src=["']([^"']+)["']/i;
        //gs.info(img);
        if (img)
            var match = img.match(regex);
        var retval = '';
        if (match && match[1]) {
            retval = match[1];
        } else {
            retval = 'https://backs.scryfall.io/normal/2/2/222b7a3b-2321-4d4c-af19-19338b134971.jpg?1677416389';
        }
        return retval;
    },

    type: 'magic_utils'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-05-31 01:08:27</sys_created_on>
        <sys_id>7b63953c936a0210a066fa497bba10db</sys_id>
        <sys_mod_count>71</sys_mod_count>
        <sys_name>magic_utils</sys_name>
        <sys_package display_value="Magic Collection" source="x_759224_magic_c_0">c09f498f9741a1107720f0571153afe1</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Magic Collection">c09f498f9741a1107720f0571153afe1</sys_scope>
        <sys_update_name>sys_script_include_7b63953c936a0210a066fa497bba10db</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-04 13:55:30</sys_updated_on>
    </sys_script_include>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>7b63953c936a0210a066fa497bba10db</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-11-19 00:52:03</sys_created_on>
        <sys_id>7c028bc8c3021210b7cebd73e401319a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-11-19 00:52:03</sys_updated_on>
        <table>sys_script_include</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
