<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_atf_step">
    <sys_atf_step action="INSERT_OR_UPDATE">
        <active>true</active>
        <callable_outputs/>
        <copied_from/>
        <description>Run Server Side Validation Script</description>
        <display_name>Run Server Side Script</display_name>
        <inputs/>
        <mugshots_cache_json/>
        <notes/>
        <order>1</order>
        <step_config display_value="Run Server Side Script">41de4a935332120028bc29cac2dc349a</step_config>
        <sys_class_name>sys_atf_step</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-02-09 04:26:38</sys_created_on>
        <sys_id>d691bd0883cb3690f17ccd60ceaad38f</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>Run Server Side Script</sys_name>
        <sys_package display_value="Magic Collection" source="x_759224_magic_c_0">c09f498f9741a1107720f0571153afe1</sys_package>
        <sys_policy/>
        <sys_scope display_value="Magic Collection">c09f498f9741a1107720f0571153afe1</sys_scope>
        <sys_update_name>sys_atf_step_d691bd0883cb3690f17ccd60ceaad38f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-02-09 15:59:11</sys_updated_on>
        <table/>
        <test display_value="Playtest Utils Jasmine Test">9f61f50883cb3690f17ccd60ceaad3f8</test>
        <timeout/>
        <warning_message/>
    </sys_atf_step>
    <sys_variable_value action="delete_multiple" query="document_key=d691bd0883cb3690f17ccd60ceaad38f"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_atf_step</document>
        <document_key>d691bd0883cb3690f17ccd60ceaad38f</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-02-09 04:26:38</sys_created_on>
        <sys_id>96c1314883cb3690f17ccd60ceaad3c8</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-02-09 04:26:38</sys_updated_on>
        <value>3.1</value>
        <variable display_value="Jasmine version">42f2564b73031300440211d8faf6a777</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_atf_step</document>
        <document_key>d691bd0883cb3690f17ccd60ceaad38f</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-02-09 04:26:38</sys_created_on>
        <sys_id>d6c1314883cb3690f17ccd60ceaad3c9</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-02-09 15:59:11</sys_updated_on>
        <value>(function(outputs, steps, params, stepResult, assertEqual) {&#13;
&#13;
    // ---- Test data ----&#13;
    var VALID_DECK_ID = '65e0479683baf650f17ccd60ceaad3fa';&#13;
&#13;
    describe('playtesterUtils.loadDeck (scoped)', function() {&#13;
&#13;
        var playtesterUtils;&#13;
&#13;
        beforeEach(function() {&#13;
            playtesterUtils = new x_759224_magic_c_0.playtest_utils();&#13;
&#13;
            // ---- Stub internal methods ----&#13;
            playtesterUtils.addAction = function() {};&#13;
&#13;
            playtesterUtils._getFormatInfo = function() {&#13;
                return {&#13;
                    success: true&#13;
                };&#13;
            };&#13;
&#13;
            playtesterUtils._populateZones = function() {&#13;
                return {&#13;
                    success: true&#13;
                };&#13;
            };&#13;
&#13;
            playtesterUtils.shuffle = function() {&#13;
                return {&#13;
                    success: true&#13;
                };&#13;
            };&#13;
&#13;
            playtesterUtils.draw = function(library, hand, count) {&#13;
                for (var i = 0; i &lt; count; i++) {&#13;
                    hand.push(library.shift());&#13;
                }&#13;
                return {&#13;
                    success: true&#13;
                };&#13;
            };&#13;
&#13;
            // ---- Mock GlideRecord ----&#13;
            spyOn(global, 'GlideRecord').and.callFake(function() {&#13;
                return {&#13;
                    get: function() {&#13;
                        return true;&#13;
                    },&#13;
                    getValue: function() {&#13;
                        return 'fake_format_sys_id';&#13;
                    }&#13;
                };&#13;
            });&#13;
        });&#13;
&#13;
        it('should successfully load a deck with a valid deckID', function() {&#13;
            var result = playtesterUtils.loadDeck(VALID_DECK_ID);&#13;
&#13;
            expect(result.success).toBe(true);&#13;
            expect(result.message).toBe('Deck properly loaded.');&#13;
            expect(playtesterUtils.zones.hand.length).toBe(7);&#13;
        });&#13;
&#13;
        it('should fail when deckID is invalid', function() {&#13;
            var result = playtesterUtils.loadDeck('');&#13;
&#13;
            expect(result.success).toBe(false);&#13;
            expect(result.message).toContain('is not valid');&#13;
        });&#13;
&#13;
        it('should fail if populateZones fails', function() {&#13;
            playtesterUtils._populateZones = function() {&#13;
                return {&#13;
                    success: false,&#13;
                    message: 'Populate failed'&#13;
                };&#13;
            };&#13;
&#13;
            var result = playtesterUtils.loadDeck(VALID_DECK_ID);&#13;
&#13;
            expect(result.success).toBe(false);&#13;
            expect(result.message).toBe('Populate failed');&#13;
        });&#13;
&#13;
        it('should fail if draw fails', function() {&#13;
            playtesterUtils.draw = function() {&#13;
                return {&#13;
                    success: false,&#13;
                    message: 'Draw failed'&#13;
                };&#13;
            };&#13;
&#13;
            var result = playtesterUtils.loadDeck(VALID_DECK_ID);&#13;
&#13;
            expect(result.success).toBe(false);&#13;
            expect(result.message).toBe('Draw failed');&#13;
        });&#13;
&#13;
    });&#13;
&#13;
})(outputs, steps, params, stepResult, assertEqual);&#13;
&#13;
// REQUIRED for jasmine execution&#13;
jasmine.getEnv().execute();</value>
        <variable display_value="Test script">989d9e235324220002c6435723dc3484</variable>
    </sys_variable_value>
</record_update>
